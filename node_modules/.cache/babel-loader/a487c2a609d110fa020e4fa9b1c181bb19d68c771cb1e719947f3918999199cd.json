{"ast":null,"code":"export const calculateDaysDifference = (start, end) => {\n  if (!start || !end) return 0;\n  const startDate = new Date(start);\n  const endDate = new Date(end);\n  return Math.floor((endDate - startDate) / (1000 * 60 * 60 * 24));\n};\nexport const calculateUrgencyScore = (daysOpen, expectedDays) => {\n  return daysOpen / expectedDays;\n};\nexport const processMetrics = requests => {\n  const metrics = {};\n  const departmentMetrics = {};\n  requests.forEach(req => {\n    const type = req.service_request_type;\n    const dept = req.city_department;\n    if (!metrics[type]) {\n      metrics[type] = {\n        total: 0,\n        resolved: 0,\n        totalDays: 0,\n        slaCompliant: 0,\n        expectedDays: req.expected_resolution_days || 5\n      };\n    }\n    metrics[type].total++;\n    if (req.status === 'Closed') {\n      metrics[type].resolved++;\n      const days = req.actual_resolution_days || 0;\n      metrics[type].totalDays += days;\n      if (days <= metrics[type].expectedDays) {\n        metrics[type].slaCompliant++;\n      }\n    }\n    if (!departmentMetrics[dept]) {\n      departmentMetrics[dept] = {\n        total: 0,\n        open: 0,\n        closed: 0\n      };\n    }\n    departmentMetrics[dept].total++;\n    if (req.status === 'Closed') {\n      departmentMetrics[dept].closed++;\n    } else {\n      departmentMetrics[dept].open++;\n    }\n  });\n  Object.keys(metrics).forEach(type => {\n    if (metrics[type].resolved > 0) {\n      metrics[type].avgResolutionDays = (metrics[type].totalDays / metrics[type].resolved).toFixed(1);\n      metrics[type].slaComplianceRate = (metrics[type].slaCompliant / metrics[type].resolved * 100).toFixed(0);\n    } else {\n      metrics[type].avgResolutionDays = 0;\n      metrics[type].slaComplianceRate = 0;\n    }\n  });\n  return {\n    byType: metrics,\n    byDepartment: departmentMetrics\n  };\n};\nexport const calculateBacklog = requests => {\n  const now = new Date();\n  return requests.filter(r => r.status !== 'Closed').map(r => {\n    const created = new Date(r.created_date);\n    const daysOpen = Math.floor((now - created) / (1000 * 60 * 60 * 24));\n    const expected = r.expected_resolution_days || 5;\n    return {\n      ...r,\n      daysOpen,\n      expectedDays: expected,\n      pastDue: daysOpen > expected,\n      urgencyScore: calculateUrgencyScore(daysOpen, expected)\n    };\n  }).sort((a, b) => b.urgencyScore - a.urgencyScore);\n};","map":{"version":3,"names":["calculateDaysDifference","start","end","startDate","Date","endDate","Math","floor","calculateUrgencyScore","daysOpen","expectedDays","processMetrics","requests","metrics","departmentMetrics","forEach","req","type","service_request_type","dept","city_department","total","resolved","totalDays","slaCompliant","expected_resolution_days","status","days","actual_resolution_days","open","closed","Object","keys","avgResolutionDays","toFixed","slaComplianceRate","byType","byDepartment","calculateBacklog","now","filter","r","map","created","created_date","expected","pastDue","urgencyScore","sort","a","b"],"sources":["/Users/richapadhariya/Documents/pact-athon-winner/src/utils/calculations.js"],"sourcesContent":["export const calculateDaysDifference = (start, end) => {\n  if (!start || !end) return 0;\n  const startDate = new Date(start);\n  const endDate = new Date(end);\n  return Math.floor((endDate - startDate) / (1000 * 60 * 60 * 24));\n};\n\nexport const calculateUrgencyScore = (daysOpen, expectedDays) => {\n  return daysOpen / expectedDays;\n};\n\nexport const processMetrics = (requests) => {\n  const metrics = {};\n  const departmentMetrics = {};\n\n  requests.forEach(req => {\n    const type = req.service_request_type;\n    const dept = req.city_department;\n    \n    if (!metrics[type]) {\n      metrics[type] = {\n        total: 0,\n        resolved: 0,\n        totalDays: 0,\n        slaCompliant: 0,\n        expectedDays: req.expected_resolution_days || 5\n      };\n    }\n\n    metrics[type].total++;\n\n    if (req.status === 'Closed') {\n      metrics[type].resolved++;\n      const days = req.actual_resolution_days || 0;\n      metrics[type].totalDays += days;\n      if (days <= metrics[type].expectedDays) {\n        metrics[type].slaCompliant++;\n      }\n    }\n\n    if (!departmentMetrics[dept]) {\n      departmentMetrics[dept] = { total: 0, open: 0, closed: 0 };\n    }\n    departmentMetrics[dept].total++;\n    if (req.status === 'Closed') {\n      departmentMetrics[dept].closed++;\n    } else {\n      departmentMetrics[dept].open++;\n    }\n  });\n\n  Object.keys(metrics).forEach(type => {\n    if (metrics[type].resolved > 0) {\n      metrics[type].avgResolutionDays = (metrics[type].totalDays / metrics[type].resolved).toFixed(1);\n      metrics[type].slaComplianceRate = ((metrics[type].slaCompliant / metrics[type].resolved) * 100).toFixed(0);\n    } else {\n      metrics[type].avgResolutionDays = 0;\n      metrics[type].slaComplianceRate = 0;\n    }\n  });\n\n  return { byType: metrics, byDepartment: departmentMetrics };\n};\n\nexport const calculateBacklog = (requests) => {\n  const now = new Date();\n  return requests\n    .filter(r => r.status !== 'Closed')\n    .map(r => {\n      const created = new Date(r.created_date);\n      const daysOpen = Math.floor((now - created) / (1000 * 60 * 60 * 24));\n      const expected = r.expected_resolution_days || 5;\n      \n      return {\n        ...r,\n        daysOpen,\n        expectedDays: expected,\n        pastDue: daysOpen > expected,\n        urgencyScore: calculateUrgencyScore(daysOpen, expected)\n      };\n    })\n    .sort((a, b) => b.urgencyScore - a.urgencyScore);\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}